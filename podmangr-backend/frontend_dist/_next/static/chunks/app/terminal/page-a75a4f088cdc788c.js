(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6519],{729:()=>{},6559:(e,n,r)=>{Promise.resolve().then(r.bind(r,7183))},7183:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>m});var t=r(5155),l=r(2115);r(729);var s=r(63),o=r(6707),i=r(5781),a=r(3209),c=r(7003),d=r(803),u=r(7624),h=r(7354);function m(){let{user:e,isLoading:n}=(0,o.A)(),m=(0,s.useRouter)(),f=(0,l.useRef)(null),p=(0,l.useRef)(null),x=(0,l.useRef)(null),w=(0,l.useRef)(null),[g,b]=(0,l.useState)(!1),[j,v]=(0,l.useState)(!1),[y,k]=(0,l.useState)(!1),N=(null==e?void 0:e.role)==="admin"||(null==e?void 0:e.role)==="operator"||(null==e?void 0:e.is_pam_admin);return((0,l.useEffect)(()=>{n||e?n||!e||N||m.push("/dashboard"):m.push("/login")},[e,n,N,m]),(0,l.useEffect)(()=>{if(!f.current||!e)return;let n=null,t=null,l=null;(async()=>{let[{Terminal:e},{FitAddon:s},{WebLinksAddon:o}]=await Promise.all([r.e(1081).then(r.t.bind(r,5318,23)),r.e(4326).then(r.t.bind(r,4326,23)),r.e(3478).then(r.t.bind(r,3478,23))]);n=new e({cursorBlink:!0,fontSize:14,fontFamily:'Menlo, Monaco, "Courier New", monospace',theme:{background:"#1e1e1e",foreground:"#d4d4d4",cursor:"#d4d4d4",black:"#000000",red:"#cd3131",green:"#0dbc79",yellow:"#e5e510",blue:"#2472c8",magenta:"#bc3fbc",cyan:"#11a8cd",white:"#e5e5e5",brightBlack:"#666666",brightRed:"#f14c4c",brightGreen:"#23d18b",brightYellow:"#f5f543",brightBlue:"#3b8eea",brightMagenta:"#d670d6",brightCyan:"#29b8db",brightWhite:"#ffffff"},allowProposedApi:!0}),l=new s;let i=new o;n.loadAddon(l),n.loadAddon(i),w.current=l,p.current=n,f.current&&n.open(f.current),k(!0),setTimeout(()=>{try{null==l||l.fit()}catch(e){console.error("Error fitting terminal:",e)}},10);let a=localStorage.getItem("podmangr-token");if(!a)return n.writeln("\r\n\x1b[1;31mNo authentication token found\x1b[0m\r\n");let c="3000"===window.location.port,d=c?"ws:":"https:"===window.location.protocol?"wss:":"ws:",u=c?"".concat(window.location.hostname,":8080"):window.location.host,h="".concat(d,"//").concat(u,"/api/terminal/ws?token=").concat(encodeURIComponent(a));console.log("Connecting to WebSocket:",h.replace(a,"***")),x.current=t=new WebSocket(h),t.onopen=()=>{b(!0),n&&(null==t||t.send(JSON.stringify({type:"resize",rows:n.rows,cols:n.cols})))},t.onmessage=e=>{null==n||n.write(e.data)},t.onerror=e=>{console.error("WebSocket error:",e),null==n||n.writeln("\r\n\x1b[1;31mWebSocket connection error\x1b[0m\r\n"),b(!1)},t.onclose=e=>{console.log("WebSocket closed:",e.code,e.reason),null==n||n.writeln("\r\n\x1b[1;33mConnection closed\x1b[0m\r\n"),b(!1)},n.onData(e=>{(null==t?void 0:t.readyState)===WebSocket.OPEN&&t.send(JSON.stringify({type:"input",data:e}))}),n.onResize(e=>{let{rows:n,cols:r}=e;(null==t?void 0:t.readyState)===WebSocket.OPEN&&t.send(JSON.stringify({type:"resize",rows:n,cols:r}))})})();let s=()=>{try{var e;null==(e=w.current)||e.fit()}catch(e){console.error("Error fitting terminal on resize:",e)}};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),null==t||t.close(),null==n||n.dispose()}},[e]),!n&&e&&N)?(0,t.jsx)(i.N,{children:(0,t.jsxs)("div",{className:"flex flex-col ".concat(j?"h-screen":"h-full"," p-4 gap-4"),children:[(0,t.jsxs)(a.Zp,{className:j?"flex-1 flex flex-col":"",children:[(0,t.jsxs)(a.aR,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(a.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(d.A,{className:"w-5 h-5"}),"Terminal"]}),(0,t.jsxs)(a.BT,{children:["Interactive shell terminal",g&&(0,t.jsx)("span",{className:"ml-2 text-green-600",children:"● Connected"}),!g&&(0,t.jsx)("span",{className:"ml-2 text-red-600",children:"● Disconnected"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[!g&&y&&(0,t.jsx)(c.$,{onClick:()=>{x.current&&x.current.close(),window.location.reload()},variant:"outline",size:"sm",children:"Reconnect"}),(0,t.jsx)(c.$,{onClick:()=>{v(!j),setTimeout(()=>{try{var e;null==(e=w.current)||e.fit()}catch(e){console.error("Error fitting terminal in fullscreen:",e)}},100)},variant:"outline",size:"sm",className:"flex items-center gap-2",children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.A,{className:"w-4 h-4"}),"Exit Fullscreen"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"w-4 h-4"}),"Fullscreen"]})})]})]}),(0,t.jsx)(a.Wu,{className:j?"flex-1 p-0":"p-0",children:(0,t.jsx)("div",{ref:f,className:"w-full ".concat(j?"h-full":"h-[600px]"," bg-[#1e1e1e] rounded-b-lg overflow-hidden"),style:{padding:"8px"}})})]}),!j&&(0,t.jsxs)(a.Zp,{children:[(0,t.jsx)(a.aR,{children:(0,t.jsx)(a.ZB,{children:"Terminal Tips"})}),(0,t.jsxs)(a.Wu,{className:"space-y-2 text-sm text-muted-foreground",children:[(0,t.jsx)("p",{children:"• This is a fully interactive shell terminal running on the server"}),(0,t.jsx)("p",{children:"• Supports colors, cursor movement, and all standard terminal features"}),(0,t.jsx)("p",{children:"• Use Ctrl+C to interrupt running processes"}),(0,t.jsx)("p",{children:"• Your default shell environment is loaded automatically"}),(0,t.jsx)("p",{children:"• Terminal sessions are isolated per connection"})]})]})]})}):(0,t.jsx)(i.N,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("p",{children:"Loading..."})})})}},7354:(e,n,r)=>{"use strict";r.d(n,{A:()=>t});let t=(0,r(1847).A)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]])},7624:(e,n,r)=>{"use strict";r.d(n,{A:()=>t});let t=(0,r(1847).A)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]])}},e=>{e.O(0,[3786,4095,6189,2940,9837,8441,1255,7358],()=>e(e.s=6559)),_N_E=e.O()}]);