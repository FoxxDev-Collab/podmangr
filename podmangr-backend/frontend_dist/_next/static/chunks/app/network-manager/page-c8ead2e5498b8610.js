(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9949],{120:(e,s,t)=>{"use strict";t.d(s,{$v:()=>p,EO:()=>x,Lt:()=>i,Rx:()=>j,Zr:()=>f,ck:()=>m,r7:()=>h,tv:()=>c,wd:()=>u});var a=t(5155);t(2115);var r=t(2498),l=t(5016),n=t(7003);function i(e){let{...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"alert-dialog",...s})}function c(e){let{...s}=e;return(0,a.jsx)(r.l9,{"data-slot":"alert-dialog-trigger",...s})}function o(e){let{...s}=e;return(0,a.jsx)(r.ZL,{"data-slot":"alert-dialog-portal",...s})}function d(e){let{className:s,...t}=e;return(0,a.jsx)(r.hJ,{"data-slot":"alert-dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function x(e){let{className:s,...t}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(d,{}),(0,a.jsx)(r.UC,{"data-slot":"alert-dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...t})]})}function u(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function m(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,l.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function h(e){let{className:s,...t}=e;return(0,a.jsx)(r.hE,{"data-slot":"alert-dialog-title",className:(0,l.cn)("text-lg font-semibold",s),...t})}function p(e){let{className:s,...t}=e;return(0,a.jsx)(r.VY,{"data-slot":"alert-dialog-description",className:(0,l.cn)("text-muted-foreground text-sm",s),...t})}function j(e){let{className:s,...t}=e;return(0,a.jsx)(r.rc,{className:(0,l.cn)((0,n.r)(),s),...t})}function f(e){let{className:s,...t}=e;return(0,a.jsx)(r.ZD,{className:(0,l.cn)((0,n.r)({variant:"outline"}),s),...t})}},235:(e,s,t)=>{"use strict";t.d(s,{J:()=>n});var a=t(5155);t(2115);var r=t(489),l=t(5016);function n(e){let{className:s,...t}=e;return(0,a.jsx)(r.b,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}},923:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>c,av:()=>o,j7:()=>i,tU:()=>n});var a=t(5155);t(2115);var r=t(5218),l=t(5016);function n(e){let{className:s,...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"tabs",className:(0,l.cn)("flex flex-col gap-2",s),...t})}function i(e){let{className:s,...t}=e;return(0,a.jsx)(r.B8,{"data-slot":"tabs-list",className:(0,l.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function c(e){let{className:s,...t}=e;return(0,a.jsx)(r.l9,{"data-slot":"tabs-trigger",className:(0,l.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function o(e){let{className:s,...t}=e;return(0,a.jsx)(r.UC,{"data-slot":"tabs-content",className:(0,l.cn)("flex-1 outline-none",s),...t})}},953:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>P});var a=t(5155),r=t(2115),l=t(63),n=t(6707),i=t(3209),c=t(7003),o=t(6170),d=t(235),x=t(923),u=t(7812),m=t(4679),h=t(7507),p=t(120),j=t(5781),f=t(4172),g=t(3166),v=t(4639),b=t(2840),N=t(906),w=t(7910),y=t(5917),k=t(5229),A=t(1696),C=t(3341),z=t(9559),S=t(9068),E=t(6191),B=t(1360),_=t(2056);function P(){let{isAuthenticated:e,isLoading:s,token:t,user:P}=(0,n.A)(),T=(0,l.useRouter)(),[R,Z]=(0,r.useState)(""),[L,I]=(0,r.useState)("interfaces"),D=(null==P?void 0:P.role)==="admin"||(null==P?void 0:P.role)==="operator"||(null==P?void 0:P.is_pam_admin),[F,O]=(0,r.useState)([]),[J,M]=(0,r.useState)({}),[$,U]=(0,r.useState)(null),[W,q]=(0,r.useState)([]),[G,V]=(0,r.useState)([]),[X,H]=(0,r.useState)([]),[K,Y]=(0,r.useState)(null),[Q,ee]=(0,r.useState)([]),[es,et]=(0,r.useState)(null),[ea,er]=(0,r.useState)(!1),[el,en]=(0,r.useState)(!1),[ei,ec]=(0,r.useState)(!1),[eo,ed]=(0,r.useState)(!1),[ex,eu]=(0,r.useState)(!1),[em,eh]=(0,r.useState)(!1),[ep,ej]=(0,r.useState)({success:!1,message:""}),[ef,eg]=(0,r.useState)(null),[ev,eb]=(0,r.useState)(""),[eN,ew]=(0,r.useState)({port:"",protocol:"tcp"}),[ey,ek]=(0,r.useState)({destination:"",gateway:"",interface:"",metric:0}),[eA,eC]=(0,r.useState)({type:"",zone:"",value:""}),[ez,eS]=(0,r.useState)({protocol:"",state:""}),eE=(null==P?void 0:P.role)==="admin",eB=(0,r.useCallback)(async()=>{if(t)try{let e=await fetch("/api/network/interfaces",{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let s=await e.json();O(s||[]);let a=(s||[]).map(async e=>{let s=await fetch("/api/network/interfaces/".concat(e.name,"/stats"),{headers:{Authorization:"Bearer ".concat(t)}});return s.ok?{name:e.name,stats:await s.json()}:null}),r=await Promise.all(a),l={};r.forEach(e=>{e&&(l[e.name]=e.stats)}),M(l)}}catch(e){}},[t]),e_=(0,r.useCallback)(async()=>{if(t)try{let[e,s,a]=await Promise.all([fetch("/api/network/firewall/status",{headers:{Authorization:"Bearer ".concat(t)}}),fetch("/api/network/firewall/zones",{headers:{Authorization:"Bearer ".concat(t)}}),fetch("/api/network/firewall/services",{headers:{Authorization:"Bearer ".concat(t)}})]);e.ok&&U(await e.json()),s.ok&&q(await s.json()),a.ok&&V(await a.json())}catch(e){}},[t]),eP=(0,r.useCallback)(async()=>{if(t)try{let[e,s]=await Promise.all([fetch("/api/network/routes",{headers:{Authorization:"Bearer ".concat(t)}}),fetch("/api/network/dns",{headers:{Authorization:"Bearer ".concat(t)}})]);e.ok&&H(await e.json()),s.ok&&Y(await s.json())}catch(e){}},[t]),eT=(0,r.useCallback)(async()=>{if(t)try{let e=new URLSearchParams;ez.protocol&&e.append("protocol",ez.protocol),ez.state&&e.append("state",ez.state);let s=await fetch("/api/network/connections?".concat(e),{headers:{Authorization:"Bearer ".concat(t)}});s.ok&&ee(await s.json())}catch(e){}},[t,ez]),eR=(0,r.useCallback)(async()=>{er(!0),et(null);try{await Promise.all([eB(),e_(),eP(),eT()])}catch(e){et(e instanceof Error?e.message:"Failed to fetch network data")}finally{er(!1)}},[eB,e_,eP,eT]);(0,r.useEffect)(()=>{s||e?s||!e||D||T.push("/dashboard"):T.push("/login")},[e,s,D,T]),(0,r.useEffect)(()=>{let e=()=>{Z(new Date().toLocaleTimeString("en-US",{hour12:!1}))};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[]),(0,r.useEffect)(()=>{if(e&&t){eR();let e=setInterval(eR,3e4);return()=>clearInterval(e)}},[e,t,eR]),(0,r.useEffect)(()=>{e&&t&&eT()},[ez,e,t,eT]);let eZ=e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,s)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][s])},eL=async()=>{if(ef&&ev&&t)try{let e=await fetch("/api/network/firewall/zones/".concat(ef.name,"/services"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({service:ev,permanent:!0})}),s=await e.json();ej({success:e.ok,message:e.ok?"Service added successfully":s.error||"Failed to add service"}),eh(!0),en(!1),e.ok&&e_()}catch(e){ej({success:!1,message:"Failed to add service"}),eh(!0)}},eI=async()=>{if(ef&&eN.port&&t)try{let e=await fetch("/api/network/firewall/zones/".concat(ef.name,"/ports"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({port:parseInt(eN.port),protocol:eN.protocol,permanent:!0})}),s=await e.json();ej({success:e.ok,message:e.ok?"Port added successfully":s.error||"Failed to add port"}),eh(!0),ec(!1),e.ok&&e_()}catch(e){ej({success:!1,message:"Failed to add port"}),eh(!0)}},eD=async()=>{if(ey.destination&&t)try{let e=await fetch("/api/network/routes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(ey)}),s=await e.json();ej({success:e.ok,message:e.ok?"Route added successfully":s.error||"Failed to add route"}),eh(!0),ed(!1),e.ok&&eP()}catch(e){ej({success:!1,message:"Failed to add route"}),eh(!0)}},eF=async()=>{if(t)try{let e;if("service"===eA.type?e=await fetch("/api/network/firewall/zones/".concat(eA.zone,"/services/").concat(eA.value,"?permanent=true"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}):"port"===eA.type?e=await fetch("/api/network/firewall/zones/".concat(eA.zone,"/ports/").concat(eA.value,"?permanent=true"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}):"route"===eA.type&&(e=await fetch("/api/network/routes/".concat(encodeURIComponent(eA.value)),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})),e){let s=await e.json();ej({success:e.ok,message:e.ok?"Deleted successfully":s.error||"Failed to delete"}),eh(!0),eu(!1),e.ok&&("route"===eA.type?eP():e_())}}catch(e){ej({success:!1,message:"Failed to delete"}),eh(!0)}},eO=async()=>{if(t)try{let e=await fetch("/api/network/firewall/reload",{method:"POST",headers:{Authorization:"Bearer ".concat(t)}}),s=await e.json();ej({success:e.ok,message:e.ok?"Firewall reloaded":s.error||"Failed to reload"}),eh(!0),e.ok&&e_()}catch(e){ej({success:!1,message:"Failed to reload firewall"}),eh(!0)}};return!s&&e&&D?(0,a.jsxs)(j.N,{title:"NETWORK MANAGER",time:R,children:[(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Interfaces"}),(0,a.jsx)(v.A,{className:"w-4 h-4 text-accent"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:F.length}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[F.filter(e=>"up"===e.state).length," active"]})]})]}),(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Firewall"}),(0,a.jsx)(w.A,{className:"w-4 h-4 text-chart-3"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsxs)("div",{className:"text-3xl font-bold flex items-center gap-2",children:[(null==$?void 0:$.running)?(0,a.jsx)(y.A,{className:"w-6 h-6 text-green-500"}):(0,a.jsx)(k.A,{className:"w-6 h-6 text-destructive"}),(null==$?void 0:$.running)?"Active":"Inactive"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Default: ",(null==$?void 0:$.default_zone)||"N/A"]})]})]}),(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Routes"}),(0,a.jsx)(A.A,{className:"w-4 h-4 text-chart-4"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:X.length}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"routing entries"})]})]}),(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),(0,a.jsx)(C.A,{className:"w-4 h-4 text-chart-5"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:Q.length}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[Q.filter(e=>"ESTAB"===e.state).length," established"]})]})]})]}),es&&(0,a.jsx)("div",{className:"p-4 rounded-lg border border-destructive/50 bg-destructive/10 text-destructive",children:es}),(0,a.jsxs)(x.tU,{value:L,onValueChange:I,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)(x.j7,{children:[(0,a.jsxs)(x.Xi,{value:"interfaces",className:"gap-2",children:[(0,a.jsx)(v.A,{className:"w-4 h-4"}),"Interfaces"]}),(0,a.jsxs)(x.Xi,{value:"firewall",className:"gap-2",children:[(0,a.jsx)(w.A,{className:"w-4 h-4"}),"Firewall"]}),(0,a.jsxs)(x.Xi,{value:"routes",className:"gap-2",children:[(0,a.jsx)(A.A,{className:"w-4 h-4"}),"Routes"]}),(0,a.jsxs)(x.Xi,{value:"connections",className:"gap-2",children:[(0,a.jsx)(C.A,{className:"w-4 h-4"}),"Connections"]})]}),(0,a.jsx)(c.$,{variant:"ghost",size:"sm",onClick:eR,disabled:ea,children:(0,a.jsx)(z.A,{className:"w-4 h-4 ".concat(ea?"animate-spin":"")})})]}),(0,a.jsx)(x.av,{value:"interfaces",children:(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsx)(i.aR,{children:(0,a.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"w-5 h-5 text-accent"}),"Network Interfaces"]})}),(0,a.jsx)(i.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:F.map(e=>(0,a.jsx)("div",{className:"p-4 rounded-lg border border-border/50 bg-background/40",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(e=>{switch(e){case"loopback":return(0,a.jsx)(f.A,{className:"w-4 h-4"});case"wireless":return(0,a.jsx)(g.A,{className:"w-4 h-4"});case"bridge":case"virtual":return(0,a.jsx)(v.A,{className:"w-4 h-4"});default:return(0,a.jsx)(b.A,{className:"w-4 h-4"})}})(e.type),(0,a.jsx)("h3",{className:"font-semibold font-mono",children:e.name}),(0,a.jsx)(u.E,{variant:"up"===e.state?"default":"secondary",children:e.state}),(0,a.jsx)(u.E,{variant:"outline",children:e.type}),e.is_physical&&(0,a.jsx)(u.E,{variant:"outline",children:"Physical"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"MAC:"}),(0,a.jsx)("span",{className:"ml-2 font-mono",children:e.mac||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"MTU:"}),(0,a.jsx)("span",{className:"ml-2",children:e.mtu})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Speed:"}),(0,a.jsx)("span",{className:"ml-2",children:e.speed>0?"".concat(e.speed," Mbps"):"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Driver:"}),(0,a.jsx)("span",{className:"ml-2",children:e.driver||"N/A"})]})]}),(e.ipv4.length>0||e.ipv6.length>0)&&(0,a.jsxs)("div",{className:"mt-3 space-y-1",children:[e.ipv4.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(S.A,{className:"w-3 h-3 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-mono text-accent",children:e}),(0,a.jsx)(u.E,{variant:"outline",className:"text-xs",children:"IPv4"})]},s)),e.ipv6.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(S.A,{className:"w-3 h-3 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-mono text-xs",children:e}),(0,a.jsx)(u.E,{variant:"outline",className:"text-xs",children:"IPv6"})]},s))]}),J[e.name]&&(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-muted-foreground",children:[(0,a.jsxs)("div",{children:["RX: ",eZ(J[e.name].rx_bytes)]}),(0,a.jsxs)("div",{children:["TX: ",eZ(J[e.name].tx_bytes)]}),(0,a.jsxs)("div",{children:["Packets RX: ",J[e.name].rx_packets]}),(0,a.jsxs)("div",{children:["Packets TX: ",J[e.name].tx_packets]})]})]})})},e.name))})})]})}),(0,a.jsx)(x.av,{value:"firewall",children:(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"w-5 h-5 text-chart-3"}),"Firewall Zones"]}),eE&&(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:eO,children:[(0,a.jsx)(z.A,{className:"w-4 h-4 mr-2"}),"Reload Firewall"]})]}),(0,a.jsx)(i.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:W.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border border-border/50 bg-background/40",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),e.is_default&&(0,a.jsx)(u.E,{children:"Default"}),e.is_active&&(0,a.jsx)(u.E,{variant:"outline",className:"text-green-500 border-green-500",children:"Active"}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Target: ",e.target||"default"]})]}),eE&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.$,{variant:"ghost",size:"sm",onClick:()=>{eg(e),eb(""),en(!0)},children:[(0,a.jsx)(E.A,{className:"w-4 h-4 mr-1"}),"Service"]}),(0,a.jsxs)(c.$,{variant:"ghost",size:"sm",onClick:()=>{eg(e),ew({port:"",protocol:"tcp"}),ec(!0)},children:[(0,a.jsx)(E.A,{className:"w-4 h-4 mr-1"}),"Port"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[e.interfaces.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Interfaces:"}),e.interfaces.map(e=>(0,a.jsx)(u.E,{variant:"secondary",children:e},e))]}),e.services.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Services:"}),e.services.map(s=>(0,a.jsxs)(u.E,{variant:"outline",className:"gap-1 cursor-pointer hover:bg-destructive/10",onClick:()=>{eE&&(eC({type:"service",zone:e.name,value:s}),eu(!0))},children:[s,eE&&(0,a.jsx)(k.A,{className:"w-3 h-3"})]},s))]}),e.ports.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Ports:"}),e.ports.map(s=>(0,a.jsxs)(u.E,{variant:"outline",className:"gap-1 cursor-pointer hover:bg-destructive/10",onClick:()=>{eE&&(eC({type:"port",zone:e.name,value:s}),eu(!0))},children:[s,eE&&(0,a.jsx)(k.A,{className:"w-3 h-3"})]},s))]}),e.masquerade&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,a.jsx)(y.A,{className:"w-4 h-4 inline mr-1 text-green-500"}),"Masquerading enabled"]})]})]},e.name))})})]})}),(0,a.jsx)(x.av,{value:"routes",children:(0,a.jsxs)("div",{className:"space-y-6",children:[K&&(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsx)(i.aR,{children:(0,a.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(S.A,{className:"w-5 h-5 text-chart-4"}),"DNS Configuration"]})}),(0,a.jsx)(i.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{className:"text-muted-foreground",children:"Hostname"}),(0,a.jsx)("p",{className:"font-mono",children:K.hostname})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{className:"text-muted-foreground",children:"FQDN"}),(0,a.jsx)("p",{className:"font-mono",children:K.fqdn||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{className:"text-muted-foreground",children:"Nameservers"}),(0,a.jsx)("div",{className:"space-y-1",children:K.nameservers.map((e,s)=>(0,a.jsx)("p",{className:"font-mono text-sm",children:e},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{className:"text-muted-foreground",children:"Search Domains"}),(0,a.jsx)("div",{className:"space-y-1",children:K.search.map((e,s)=>(0,a.jsx)("p",{className:"font-mono text-sm",children:e},s))})]})]})})]}),(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(A.A,{className:"w-5 h-5 text-chart-4"}),"Routing Table"]}),eE&&(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{ek({destination:"",gateway:"",interface:"",metric:0}),ed(!0)},children:[(0,a.jsx)(E.A,{className:"w-4 h-4 mr-2"}),"Add Route"]})]}),(0,a.jsx)(i.Wu,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-border/50",children:[(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Destination"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Gateway"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Interface"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Metric"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Protocol"}),eE&&(0,a.jsx)("th",{className:"text-right p-2 text-muted-foreground",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:X.map((e,s)=>(0,a.jsxs)("tr",{className:"border-b border-border/30 hover:bg-muted/20",children:[(0,a.jsx)("td",{className:"p-2 font-mono",children:e.destination}),(0,a.jsx)("td",{className:"p-2 font-mono",children:e.gateway||"-"}),(0,a.jsx)("td",{className:"p-2",children:e.interface}),(0,a.jsx)("td",{className:"p-2",children:e.metric}),(0,a.jsx)("td",{className:"p-2",children:e.protocol}),eE&&(0,a.jsx)("td",{className:"p-2 text-right",children:(0,a.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>{eC({type:"route",zone:"",value:e.destination}),eu(!0)},children:(0,a.jsx)(B.A,{className:"w-4 h-4 text-destructive"})})})]},s))})]})})})]})]})}),(0,a.jsx)(x.av,{value:"connections",children:(0,a.jsxs)(i.Zp,{className:"border-border/60 bg-card/70 backdrop-blur-sm",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"w-5 h-5 text-chart-5"}),"Active Connections"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(h.l6,{value:ez.protocol,onValueChange:e=>eS(s=>({...s,protocol:e})),children:[(0,a.jsx)(h.bq,{className:"w-32",children:(0,a.jsx)(h.yv,{placeholder:"Protocol"})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"all",children:"All"}),(0,a.jsx)(h.eb,{value:"tcp",children:"TCP"}),(0,a.jsx)(h.eb,{value:"udp",children:"UDP"})]})]}),(0,a.jsxs)(h.l6,{value:ez.state,onValueChange:e=>eS(s=>({...s,state:e})),children:[(0,a.jsx)(h.bq,{className:"w-40",children:(0,a.jsx)(h.yv,{placeholder:"State"})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"all",children:"All States"}),(0,a.jsx)(h.eb,{value:"ESTABLISHED",children:"Established"}),(0,a.jsx)(h.eb,{value:"LISTEN",children:"Listening"}),(0,a.jsx)(h.eb,{value:"TIME-WAIT",children:"Time Wait"})]})]})]})]}),(0,a.jsx)(i.Wu,{children:(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-border/50",children:[(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Protocol"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Local Address"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Remote Address"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"State"}),(0,a.jsx)("th",{className:"text-left p-2 text-muted-foreground",children:"Process"})]})}),(0,a.jsx)("tbody",{children:Q.slice(0,100).map((e,s)=>(0,a.jsxs)("tr",{className:"border-b border-border/30 hover:bg-muted/20",children:[(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)(u.E,{variant:"outline",children:e.protocol.toUpperCase()})}),(0,a.jsxs)("td",{className:"p-2 font-mono text-xs",children:[e.local_addr,":",e.local_port]}),(0,a.jsxs)("td",{className:"p-2 font-mono text-xs",children:[e.remote_addr,":",e.remote_port]}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)(u.E,{variant:"ESTAB"===e.state?"default":"secondary",className:"text-xs",children:e.state})}),(0,a.jsx)("td",{className:"p-2 text-xs",children:e.process?"".concat(e.process," (").concat(e.pid,")"):"-"})]},s))})]}),Q.length>100&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:["Showing 100 of ",Q.length," connections"]})]})})]})})]})]}),(0,a.jsx)(m.lG,{open:el,onOpenChange:en,children:(0,a.jsxs)(m.Cf,{children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsxs)(m.L3,{children:["Add Service to ",null==ef?void 0:ef.name]}),(0,a.jsx)(m.rr,{children:"Allow a service through the firewall in this zone."})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)(d.J,{children:"Service"}),(0,a.jsxs)(h.l6,{value:ev,onValueChange:eb,children:[(0,a.jsx)(h.bq,{className:"mt-2",children:(0,a.jsx)(h.yv,{placeholder:"Select a service"})}),(0,a.jsx)(h.gC,{className:"max-h-60",children:G.filter(e=>!(null==ef?void 0:ef.services.includes(e))).map(e=>(0,a.jsx)(h.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)(m.Es,{children:[(0,a.jsx)(c.$,{variant:"outline",onClick:()=>en(!1),children:"Cancel"}),(0,a.jsx)(c.$,{onClick:eL,disabled:!ev,children:"Add Service"})]})]})}),(0,a.jsx)(m.lG,{open:ei,onOpenChange:ec,children:(0,a.jsxs)(m.Cf,{children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsxs)(m.L3,{children:["Add Port to ",null==ef?void 0:ef.name]}),(0,a.jsx)(m.rr,{children:"Open a port in this firewall zone."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"Port Number"}),(0,a.jsx)(o.p,{type:"number",min:1,max:65535,placeholder:"e.g., 8080",value:eN.port,onChange:e=>ew(s=>({...s,port:e.target.value})),className:"mt-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"Protocol"}),(0,a.jsxs)(h.l6,{value:eN.protocol,onValueChange:e=>ew(s=>({...s,protocol:e})),children:[(0,a.jsx)(h.bq,{className:"mt-2",children:(0,a.jsx)(h.yv,{})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"tcp",children:"TCP"}),(0,a.jsx)(h.eb,{value:"udp",children:"UDP"})]})]})]})]}),(0,a.jsxs)(m.Es,{children:[(0,a.jsx)(c.$,{variant:"outline",onClick:()=>ec(!1),children:"Cancel"}),(0,a.jsx)(c.$,{onClick:eI,disabled:!eN.port,children:"Add Port"})]})]})}),(0,a.jsx)(m.lG,{open:eo,onOpenChange:ed,children:(0,a.jsxs)(m.Cf,{children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsx)(m.L3,{children:"Add Static Route"}),(0,a.jsx)(m.rr,{children:"Add a new route to the routing table."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"Destination (CIDR)"}),(0,a.jsx)(o.p,{placeholder:"e.g., 10.0.0.0/8",value:ey.destination,onChange:e=>ek(s=>({...s,destination:e.target.value})),className:"mt-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"Gateway (optional)"}),(0,a.jsx)(o.p,{placeholder:"e.g., 192.168.1.1",value:ey.gateway,onChange:e=>ek(s=>({...s,gateway:e.target.value})),className:"mt-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"Interface (optional)"}),(0,a.jsxs)(h.l6,{value:ey.interface,onValueChange:e=>ek(s=>({...s,interface:e})),children:[(0,a.jsx)(h.bq,{className:"mt-2",children:(0,a.jsx)(h.yv,{placeholder:"Select interface"})}),(0,a.jsx)(h.gC,{children:F.map(e=>(0,a.jsx)(h.eb,{value:e.name,children:e.name},e.name))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"Metric (optional)"}),(0,a.jsx)(o.p,{type:"number",min:0,placeholder:"0",value:ey.metric||"",onChange:e=>ek(s=>({...s,metric:parseInt(e.target.value)||0})),className:"mt-2"})]})]}),(0,a.jsxs)(m.Es,{children:[(0,a.jsx)(c.$,{variant:"outline",onClick:()=>ed(!1),children:"Cancel"}),(0,a.jsx)(c.$,{onClick:eD,disabled:!ey.destination,children:"Add Route"})]})]})}),(0,a.jsx)(p.Lt,{open:ex,onOpenChange:eu,children:(0,a.jsxs)(p.EO,{children:[(0,a.jsxs)(p.wd,{children:[(0,a.jsxs)(p.r7,{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"w-5 h-5 text-destructive"}),"Confirm Deletion"]}),(0,a.jsxs)(p.$v,{children:["Are you sure you want to delete this ",eA.type,"? This action may affect network connectivity."]})]}),(0,a.jsxs)(p.ck,{children:[(0,a.jsx)(p.Zr,{children:"Cancel"}),(0,a.jsx)(p.Rx,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:eF,children:"Delete"})]})]})}),(0,a.jsx)(m.lG,{open:em,onOpenChange:eh,children:(0,a.jsxs)(m.Cf,{children:[(0,a.jsx)(m.c7,{children:(0,a.jsx)(m.L3,{className:ep.success?"text-green-500":"text-destructive",children:ep.success?"Success":"Error"})}),(0,a.jsx)("div",{className:"py-4",children:(0,a.jsx)("p",{children:ep.message})}),(0,a.jsx)(m.Es,{children:(0,a.jsx)(c.$,{onClick:()=>eh(!1),children:"Close"})})]})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsx)(N.A,{className:"w-12 h-12 text-accent animate-pulse"})})}},4679:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>x,Es:()=>m,L3:()=>h,c7:()=>u,lG:()=>i,rr:()=>p,zM:()=>c});var a=t(5155);t(2115);var r=t(1590),l=t(5229),n=t(5016);function i(e){let{...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"dialog",...s})}function c(e){let{...s}=e;return(0,a.jsx)(r.l9,{"data-slot":"dialog-trigger",...s})}function o(e){let{...s}=e;return(0,a.jsx)(r.ZL,{"data-slot":"dialog-portal",...s})}function d(e){let{className:s,...t}=e;return(0,a.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function x(e){let{className:s,children:t,showCloseButton:i=!0,...c}=e;return(0,a.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,a.jsx)(d,{}),(0,a.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...c,children:[t,i&&(0,a.jsxs)(r.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(l.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function u(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function m(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function h(e){let{className:s,...t}=e;return(0,a.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg leading-none font-semibold",s),...t})}function p(e){let{className:s,...t}=e;return(0,a.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,n.cn)("text-muted-foreground text-sm",s),...t})}},6170:(e,s,t)=>{"use strict";t.d(s,{p:()=>l});var a=t(5155);t(2115);var r=t(5016);function l(e){let{className:s,type:t,...l}=e;return(0,a.jsx)("input",{type:t,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...l})}},7507:(e,s,t)=>{"use strict";t.d(s,{bq:()=>x,eb:()=>m,gC:()=>u,l6:()=>o,yv:()=>d});var a=t(5155);t(2115);var r=t(8190),l=t(4033),n=t(5917),i=t(2108),c=t(5016);function o(e){let{...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"select",...s})}function d(e){let{...s}=e;return(0,a.jsx)(r.WT,{"data-slot":"select-value",...s})}function x(e){let{className:s,size:t="default",children:n,...i}=e;return(0,a.jsxs)(r.l9,{"data-slot":"select-trigger","data-size":t,className:(0,c.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...i,children:[n,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"size-4 opacity-50"})})]})}function u(e){let{className:s,children:t,position:l="popper",align:n="center",...i}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{"data-slot":"select-content",className:(0,c.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,align:n,...i,children:[(0,a.jsx)(h,{}),(0,a.jsx)(r.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(p,{})]})})}function m(e){let{className:s,children:t,...l}=e;return(0,a.jsxs)(r.q7,{"data-slot":"select-item",className:(0,c.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(n.A,{className:"size-4"})})}),(0,a.jsx)(r.p4,{children:t})]})}function h(e){let{className:s,...t}=e;return(0,a.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(i.A,{className:"size-4"})})}function p(e){let{className:s,...t}=e;return(0,a.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(l.A,{className:"size-4"})})}},8689:(e,s,t)=>{Promise.resolve().then(t.bind(t,953))}},e=>{e.O(0,[4095,6189,2047,1679,5155,2940,9837,8441,1255,7358],()=>e(e.s=8689)),_N_E=e.O()}]);